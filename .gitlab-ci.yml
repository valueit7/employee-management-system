image: ubuntu:latest

stages:
  - noop
  - tag

noop_job:
  stage: noop
  script:
    - echo "This job does nothing."

tag_job:
  stage: tag
  script:
    - apt-get update && apt-get install -y git  # Installer git
    - git fetch --tags  # Récupérer les tags existants
    - LAST_TAG=$(git describe --tags --abbrev=0 || echo "v0.0.0")  # Gérer le cas où aucun tag n'existe
    - NEW_TAG=$(echo $LAST_TAG | awk -F. -v OFS=. '{$NF++;print}')
    - git tag -a "$NEW_TAG" -m "Release version $NEW_TAG"
    - git push origin "$NEW_TAG"
  